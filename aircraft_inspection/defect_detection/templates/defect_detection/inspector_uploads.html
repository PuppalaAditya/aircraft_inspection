<!-- ===== Upload History Summary (UI-only upgrade; no logic changes) ===== -->
<style>
  :root{
    --bg1:#0b0f17; --bg2:#0e1624;
    --glass:rgba(255,255,255,.06);
    --line:rgba(255,255,255,.08);
    --ink:#e8edf6; --muted:#9aa4b2;
    --accent:#00d4ff; --accent2:#7c4dff;
    --row:rgba(255,255,255,.03);
    --row-hover:rgba(0,212,255,.08);
  }

  /* Page background */
  body{ background: radial-gradient(1200px 800px at 80% -20%, #182338 0%, transparent 45%),
                    radial-gradient(1200px 800px at 0% 120%, #120d26 0%, transparent 45%),
                    linear-gradient(120deg,var(--bg1),var(--bg2)); color:var(--ink); }

  /* Container */
  .summary-container {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
    padding: 2rem;
  }

  /* Card */
  .table-wrapper {
    overflow: auto;
    border-radius: 16px;
    background: linear-gradient(180deg, var(--glass), rgba(255,255,255,0.04));
    backdrop-filter: blur(14px) saturate(1.2);
    border: 1px solid var(--line);
    box-shadow: 0 12px 30px rgba(0,0,0,.45), inset 0 1px 0 rgba(255,255,255,.06);
  }

  /* Heading */
  .summary-heading {
    font-size: 1.875rem;
    font-weight: 800;
    text-align: center;
    margin-bottom: 1.25rem;
    background: linear-gradient(90deg, var(--accent), var(--accent2));
    -webkit-background-clip: text; background-clip: text; color: transparent;
    filter: drop-shadow(0 2px 16px rgba(0,212,255,.25));
    letter-spacing:.2px;
  }

  .summary-subtle { text-align:center; color:var(--muted); margin:-.5rem 0 1.5rem; }

  /* Table */
  .history-table {
    width: 100%;
    border-collapse: separate;
    border-spacing: 0;
    min-width: 900px;
  }

  .history-table thead th {
    position: sticky; top: 0; z-index: 2;
    background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
    padding: 0.9rem 1.25rem;
    text-align: left;
    font-size: .72rem;
    letter-spacing: .12em;
    text-transform: uppercase;
    border-bottom: 1px solid var(--line);
    color: #cfd6e5;
    backdrop-filter: blur(10px);
  }

  .history-table tbody td {
    padding: 1rem 1.25rem;
    border-bottom: 1px dashed var(--line);
    color: #dbe3f4;
    vertical-align: top;
    background: transparent;
  }

  /* Zebra / hover */
  .history-table tbody tr:nth-child(odd) td { background: var(--row); }
  .history-table tbody tr:hover td { background: var(--row-hover); transition: background .25s ease; }

  /* Center utility */
  .text-center { text-align:center; }

  /* Thumbnail with hover zoom */
  .thumb-wrap{
    position:relative; display:flex; justify-content:center;
  }
  .thumbnail-image{
    height: 10rem; max-width: 18rem; width:auto; object-fit: contain;
    border:1px solid var(--line); border-radius: 10px; background: rgba(255,255,255,.03);
    box-shadow: inset 0 1px 0 rgba(255,255,255,.05);
    transition: transform .25s ease, box-shadow .25s ease, filter .25s ease;
  }
  .thumbnail-image:hover{
    transform: translateY(-2px) scale(1.02);
    box-shadow: 0 12px 28px rgba(0,212,255,.12);
    filter: saturate(1.1) contrast(1.05);
  }

  /* Lists */
  .predictions-list, .summary-list {
    list-style: disc inside;
    margin: 0; padding: 0;
    font-size: .90rem; line-height: 1.35rem; color: #cfe0ff;
  }
  .predictions-list li + li, .summary-list li + li { margin-top: .15rem; }

  /* Date cell */
  .date-cell { white-space: nowrap; font-size:.875rem; color:#a9b3c7; }

  /* Download button */
  .download-button {
    display: inline-flex; align-items: center; justify-content: center;
    gap:.45rem; background: linear-gradient(135deg, rgba(0,212,255,.22), rgba(124,77,255,.20));
    color: #fff; padding: .55rem 1rem; font-size: .875rem; font-weight: 700;
    border-radius: 10px; border:1px solid var(--line);
    text-decoration: none; transition: transform .12s ease, box-shadow .2s ease, opacity .2s;
  }
  .download-button:hover { transform: translateY(-1px); box-shadow: 0 14px 28px rgba(124,77,255,.23); }
  .download-button:active { transform: translateY(0); opacity:.9; }

  /* Tiny fade-in */
  .fade-in { animation: fade .5s ease both; }
  @keyframes fade { from{opacity:0; transform: translateY(6px)} to{opacity:1; transform:none} }
</style>

<div class="summary-container fade-in">
  <h2 class="summary-heading">Upload History Summary</h2>
  <p class="summary-subtle">Review detections, summaries and export reports.</p>

  <div class="table-wrapper">
    <table class="history-table">
      <thead>
        <tr>
          <th class="text-center">Image</th>
          <th>Predictions</th>
          <th>Prediction Summary</th>
          <th>Date</th>
          <th class="text-center">PDF</th>
        </tr>
      </thead>
      <tbody>
        {% for record in records %}
        <tr>
          <!-- Image Thumbnail -->
          <td class="text-center">
            <div class="thumb-wrap">
              <img src="{{ record.result_image_path }}" alt="Detected" class="thumbnail-image" />
            </div>
          </td>

          <!-- Full Prediction List -->
          <td>
            <ul class="predictions-list">
              {% for item in record.predictions_list %}
                <li>{{ item }}</li>
              {% endfor %}
            </ul>
          </td>

          <!-- Prediction Summary -->
          <td>
            <ul class="summary-list">
              {% for item in record.prediction_summary_list %}
                <li>{{ item }}</li>
              {% endfor %}
            </ul>
          </td>

          <!-- Upload Date -->
          <td class="date-cell">
            {{ record.upload_datetime|date:"Y-m-d H:i" }}
          </td>

          <!-- PDF Download -->
          <td class="text-center">
            <a href="{{ record.pdf_path }}" class="download-button" title="Download PDF report">
              <span>Download</span>
            </a>
          </td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="5" class="text-center" style="padding:2.5rem; color:#9fb1c9;">
            No uploads yet.
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
